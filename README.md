# Нейронка, которая пишет текст в стиле телеграм канала MMA science

Это приложение было создано с развлекательной целью. Нейросеть получает на вход запрос и генерирует текст в стиле автора проекта, но делает это абсурдно и смешно.

## Запуск

Запуск возможен только при наличии видеокарты и системы на Linux, поскольку приложение использует nvidia gpu. 

Для начала использования нужно иметь следующие файлы:
- docker-compose.yaml
- Makefile
- .env.example

Перед запуском при необходимости укажите в файле .env.example нужные порты, либо создайте .env файл самостоятельно. 
Далее исполните в терминале "make up". Скрипт проверит наличие в директории файла .env. В случае отсутствия он создаст его на основе .env.example
После загрузки дождитесь, чтобы fastapi открылся на указанном порту (может занять некоторое время).
После чего будут доступны ресурсы:
- http://localhost:[порт, который был указан в .env]/docs (fast api)
- http://localhost:[порт, который был указан в .env] (основное приложение для работы на gradio)

Перейдите по адресу приложения gradio и введите запрос "напиши пост в стиле mma science про...", нажмите Submit и дождитесь ответа.

## Как обучалась модель

### Модель
Была использована легковесная предобученная модель "ai-forever/rugpt3medium_based_on_gpt2". 

### Архитектура
Для дообучения использовалась LoRA с r=24, target_modules=["c_attn", "c_proj"] и квантованием модели для ускорения.  

### Железо
NVIDIA GeForce RTX 3070 Ti, 8129MiB
64Gb RAM

### Данные
На момент обучения модели на канале https://t.me/mma_science было всего 138 полноценных постов (максимальное количество символов на пост 4096).

### Стек
- Pytorch
- Hugging Face
- BitsAndBytesConfig
- LoRA
- FastAPI
- Gradio
- Docker

## Резюме
Очевидно с имеющимся железом и количеством данных невозможно дообучить модель для качественной генерации постов. У нее много галлюцинаций с потерей смысла. Но главное, что стиль автора действительно прослеживается. В случае замены модели на более мощную и увеличения числа примеров, результаты будут существенно лучше. Смысл проекта в демонстрации умений в обучении языковой модели и ее деплоя. 